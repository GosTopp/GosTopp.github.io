# Numpy 随机抽样

在统计学中，通过样本研究总体是一个基本思路，是否科学的抽样方式很大程度影响了对总体的估计，而最基本的抽样方式就是随机抽样，即尽量确保每一个个体成为样本的可能性都是相等的，是一种“等概率”抽样方式。

在 `Numpy`中，`numpy.random`提供了多种随机抽样模型，常见函数如下。

## `np.random.rand()`

`rand()`在无参数输入时，默认返回 1 个`[0, 1)`区间内的随机数。

`rand(a)`输入 1 个参数，返回 a 个`[0, 1)`区间内的随机数。

`rand(a,b)`输入 2 个参数，返回 \(a,b\) 的二维数组。

输入参数数量依此类推。

## `np.random.randn()`

`randn()`在无参数输入时，于标准正态分布（均值=0，方差=1）随机抽样一个数。

`randn(a)`输入 1 个参数，于标准正态分布随机抽样 a 个数。

`randn(a,b)`输入 2 个参数，于标准正态分布随机抽样 形成 \(a,b\) 的二维数组。

输入参数数量依此类推。

## `np.random.randint()`

`randint(i)`输入参数 i，返回 1 个`[0, i)`区间的随机数。

`randint(i,j)`输入参数 `i, j`, 返回 1 个`[i, j)`区间的随机数。

`randint(i,j,size=n)`输入参数 `i, j, size`, 返回 n 个`[i, j)`区间的随机数。

## `np.random.choice()`

`choice(a,size=n,p)`一般需要输入 3 个参数，表示从某个序列`a`中按一定概率`p`抽样形成 长度为 `n` 的序列。

如下方代码所所示，表示在以各 50% 的概率对 `0`和 `1`随机抽样 5 次 （相当于抛 5 次硬币）。

```python
>>> np.random.choice([0, 1],size=5,p=[0.5,0.5])
>>> array([0, 1, 1, 0, 1]) # 返回结果
```

## 案例：`random`函数模拟扔硬币

问题：连续扔两次硬币都朝上的概率为多少？

步骤一：`randint()`或者`choice()`模拟 100 万组随机抽样，每组 2 次，记正面=1，反面=0。

```python
>>> test=np.random.randint(2, size=(1000000, 2))
>>> test
array([[0, 1],
       [1, 0],
       [0, 1],
       ...,
       [1, 1],
       [0, 0],
       [1, 1]])
```

步骤二：每组求和，都为反面和为 0 ，一正一反和为 1 ，都为正面和为2。

```python
>>> test_sum=test.sum(axis=1)
>>> test_sum
array([1, 1, 1, ..., 2, 1, 1])
```

步骤三：计算和为2的占比，约为 25% 。

```python
>>> (test_sum==2).mean()
0.25064
```

